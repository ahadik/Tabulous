{"version":3,"sources":["webpack:///webpack/bootstrap 4a10e8309d3396689d62","webpack:///./app.js","webpack:///external \"express\"","webpack:///external \"cfenv\"","webpack:///external \"path\"","webpack:///external \"body-parser\"","webpack:///external \"mongoose\"","webpack:///external \"passport\"","webpack:///external \"connect-flash\"","webpack:///external \"cookie-parser\"","webpack:///external \"express-session\"","webpack:///external \"fs\"","webpack:///external \"source-map-support\"","webpack:///./modules/config/database.js","webpack:///./modules/config/passport.js","webpack:///external \"passport-facebook\"","webpack:///./modules/models/user.js","webpack:///external \"bcrypt-nodejs\"","webpack:///./modules/config/auth.js","webpack:///./routes.js","webpack:///./modules/upload.js","webpack:///external \"crypto\"","webpack:///external \"multer\"","webpack:///external \"mime\""],"names":[],"mappings":"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","file":"index.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap 4a10e8309d3396689d62\n **/","var express = require('express'),\n    cfenv = require('cfenv'),\n    path = require('path'),\n    bodyParser = require('body-parser'),\n    mongoose = require('mongoose'),\n    passport = require('passport'),\n    flash = require('connect-flash'),\n    cookieParser = require('cookie-parser'),\n    session = require('express-session'),\n    fs = require('fs');\n\nrequire('source-map-support').install();\n\nvar app = express(),\n    appEnv = cfenv.getAppEnv();\n\n\n// set the view engine to ejs\napp.set('view engine', 'ejs');\n\nvar configDB = require('./modules/config/database.js');\nvar options = {\n  mongos: {\n    ssl: true,\n    sslValidate: true,\n    sslCA: [fs.readFileSync('private/cert.pem')] // cert from compose.io dashboard\n  }\n}\nmongoose.connect(configDB.url(appEnv), options); // connect to our database\n\nrequire('./modules/config/passport')(passport);\n\nvar __dirname = path.resolve(path.dirname());\napp.use(express.static(path.join(__dirname, 'public')));\napp.set(path.join('views', __dirname, 'public'));\napp.use(bodyParser.urlencoded({extended: true}));\napp.use(bodyParser.json());\napp.use(cookieParser());\n\n// required for passport\napp.use(session({ secret: process.env.SESSION_SECRET })); // session secret\napp.use(passport.initialize());\napp.use(passport.session()); // persistent login sessions\napp.use(flash()); // use connect-flash for flash messages stored in session\n\nrequire('./routes.js')(app, passport); // load our routes and pass in our app and fully configured passport\n\napp.listen(3000, function() {\n    console.info('Server listening on port ' + this.address().port);\n});\n\n\n\n/** WEBPACK FOOTER **\n ** ./app.js\n **/","module.exports = require(\"express\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"express\"\n ** module id = 1\n ** module chunks = 0\n **/","module.exports = require(\"cfenv\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"cfenv\"\n ** module id = 2\n ** module chunks = 0\n **/","module.exports = require(\"path\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"path\"\n ** module id = 3\n ** module chunks = 0\n **/","module.exports = require(\"body-parser\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"body-parser\"\n ** module id = 4\n ** module chunks = 0\n **/","module.exports = require(\"mongoose\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"mongoose\"\n ** module id = 5\n ** module chunks = 0\n **/","module.exports = require(\"passport\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"passport\"\n ** module id = 6\n ** module chunks = 0\n **/","module.exports = require(\"connect-flash\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"connect-flash\"\n ** module id = 7\n ** module chunks = 0\n **/","module.exports = require(\"cookie-parser\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"cookie-parser\"\n ** module id = 8\n ** module chunks = 0\n **/","module.exports = require(\"express-session\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"express-session\"\n ** module id = 9\n ** module chunks = 0\n **/","module.exports = require(\"fs\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"fs\"\n ** module id = 10\n ** module chunks = 0\n **/","module.exports = require(\"source-map-support\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"source-map-support\"\n ** module id = 11\n ** module chunks = 0\n **/","module.exports = {\n\t'url' : function(appEnv){\n\t\tvar mongo_uri, mongo_un, mongo_pw, mongo_port, mongo_db_name;\n\t\tif (appEnv.isLocal){\n\t\t\tmongo_uri = process.env.TABULOUS_DB_URI;\n\t\t\tmongo_un = process.env.TABULOUS_DB_UN;\n\t\t\tmongo_port = process.env.TABULOUS_DB_PORT;\n\t\t\tmongo_db_name = process.env.TABULOUS_DB;\n\t\t\tmongo_pw = process.env.TABULOUS_DB_PW;\n\t\t}else{\n\t\t\tvar user_provided = JSON.parse(process.env.VCAP_SERVICES)['user-provided'];\n\t\t\tvar credentials;\n\t\t\tfor(var i=0; i<user_provided.length; i++){\n\t\t\t\tif (user_provided[i]['name'] == 'tabulous-mongo'){\n\t\t\t  \t\tcredentials = user_provided[i]['credentials']\n\t\t\t\t}\n\t\t\t}\n\t\t\tmongo_uri = credentials['uri'];\n\t\t\tmongo_port = credentials['port'];\n\t\t\tmongo_db_name = 'production';\n\t\t\tmongo_un = credentials['user'];\n\t\t\tmongo_pw = credentials['password'];\n\t\t}\n\t\treturn \"mongodb://\"+mongo_un+\":\"+mongo_pw+\"@\"+mongo_uri+\":\"+mongo_port+\"/\"+mongo_db_name+\"?ssl=true\";\n\t}\n\t//'url' : 'mongodb://<user>:<password>@aws-us-east-1-portal.16.dblayer.com:10228/development'\n\t/*\n    'url' : function(appEnv){ return 'mongodb://'+( appEnv.isLocal ? process.env.TABULOUS_DB_UN : appEnv.services()['user-provided']['credentials']['user'])\n    \t\t+':'+( appEnv.isLocal == true ? process.env.TABULOUS_DB_PW : appEnv.services()['user-provided']['credentials']['password'])\n    \t\t+'@'+( appEnv.isLocal == true ? process.env.TABULOUS_DB_URI : appEnv.services()['user-provided']['credentials']['uri'])\n    \t\t+':'+( appEnv.isLocal == true ? process.env.TABULOUS_DB_PORT : appEnv.services()['user-provided']['credentials']['port'])\n    \t\t+(appEnv.isLocal == true ? '/development?ssl=true' : '/production');\n    \t}\n    */\n};\n\n\n/** WEBPACK FOOTER **\n ** ./modules/config/database.js\n **/","// load all the things we need\nvar FacebookStrategy = require('passport-facebook').Strategy;\n\n// load up the user model\nvar User       = require('../models/user');\n\n// load the auth variables\nvar configAuth = require('./auth');\n\nmodule.exports = function(passport) {\n\n    // used to serialize the user for the session\n    passport.serializeUser(function(user, done) {\n        done(null, user.id);\n    });\n\n    // used to deserialize the user\n    passport.deserializeUser(function(id, done) {\n        User.findById(id, function(err, user) {\n            done(err, user);\n        });\n    });\n\n    // =========================================================================\n    // FACEBOOK ================================================================\n    // =========================================================================\n    passport.use(new FacebookStrategy({\n\n        // pull in our app id and secret from our auth.js file\n        clientID        : configAuth.facebookAuth.clientID,\n        clientSecret    : configAuth.facebookAuth.clientSecret,\n        callbackURL     : configAuth.facebookAuth.callbackURL,\n        profileFields: ['id', 'name', 'email']\n\n    },\n\n    // facebook will send back the token and profile\n    function(token, refreshToken, profile, done) {\n        // asynchronous\n        process.nextTick(function() {\n\n            // find the user in the database based on their facebook id\n            User.findOne({ 'facebook.id' : profile.id }, function(err, user) {\n\n                // if there is an error, stop everything and return that\n                // ie an error connecting to the database\n                if (err)\n                    return done(err);\n\n                // if the user is found, then log them in\n                if (user) {\n                    return done(null, user); // user found, return that user\n                } else {\n                    // if there is no user found with that facebook id, create them\n                    var newUser            = new User();\n                    console.log(profile);\n                    // set all of the facebook information in our user model\n                    newUser.facebook.id    = profile.id; // set the users facebook id                   \n                    newUser.facebook.token = token; // we will save the token that facebook provides to the user                    \n                    newUser.facebook.name  = profile.name.givenName + ' ' + profile.name.familyName; // look at the passport user profile to see how names are returned\n                    newUser.facebook.first_name = profile.name.givenName;\n                    newUser.facebook.last_name = profile.name.familyName;\n                    newUser.facebook.email = profile.emails[0].value; // facebook can return multiple emails so we'll take the first\n\n                    // save our user to the database\n                    newUser.save(function(err) {\n                        if (err)\n                            throw err;\n\n                        // if successful, return the new user\n                        return done(null, newUser);\n                    });\n                }\n\n            });\n        });\n\n    }));\n\n};\n\n\n/** WEBPACK FOOTER **\n ** ./modules/config/passport.js\n **/","module.exports = require(\"passport-facebook\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"passport-facebook\"\n ** module id = 14\n ** module chunks = 0\n **/","// load the things we need\nvar mongoose = require('mongoose');\nvar bcrypt   = require('bcrypt-nodejs');\n\n// define the schema for our user model\nvar userSchema = mongoose.Schema({\n\n    local            : {\n        email        : String,\n        password     : String,\n    },\n    facebook         : {\n        id           : String,\n        token        : String,\n        email        : String,\n        name         : String,\n        first_name   : String,\n        last_name    : String\n    },\n    twitter          : {\n        id           : String,\n        token        : String,\n        displayName  : String,\n        username     : String\n    },\n    google           : {\n        id           : String,\n        token        : String,\n        email        : String,\n        name         : String\n    }\n});\n\n// methods ======================\n// generating a hash\nuserSchema.methods.generateHash = function(password) {\n    return bcrypt.hashSync(password, bcrypt.genSaltSync(8), null);\n};\n\n// checking if password is valid\nuserSchema.methods.validPassword = function(password) {\n    return bcrypt.compareSync(password, this.local.password);\n};\n\n// create the model for users and expose it to our app\nmodule.exports = mongoose.model('User', userSchema);\n\n\n/** WEBPACK FOOTER **\n ** ./modules/models/user.js\n **/","module.exports = require(\"bcrypt-nodejs\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"bcrypt-nodejs\"\n ** module id = 16\n ** module chunks = 0\n **/","// expose our config directly to our application using module.exports\nmodule.exports = {\n\n    'facebookAuth' : {\n        'clientID'      : process.env.FACEBOOK_CLIENT_ID, // your App ID\n        'clientSecret'  : process.env.FACEBOOK_CLIENT_SECRET, // your App Secret\n        'callbackURL'   : 'http://localhost:3000/auth/facebook/callback'\n    }\n};\n\n\n/** WEBPACK FOOTER **\n ** ./modules/config/auth.js\n **/","module.exports = function(app, passport) {\n    var path = require('path');\n    var __dirname = path.resolve(path.dirname());\n    var upload = require('./modules/upload');\n    // route for home page\n    app.get('/', function(req, res){\n        res.render('index.ejs');\n    });\n\n    app.get('/canvas', isLoggedIn, function(req,res){\n        res.render('canvas.ejs', {\n            name : req.user.facebook.first_name,\n            newUser: true\n        });\n    });\n\n    // =====================================\n    // FACEBOOK ROUTES =====================\n    // =====================================\n    // route for facebook authentication and login\n    app.get('/auth/facebook', passport.authenticate('facebook', { scope : 'email' }));\n\n    // handle the callback after facebook has authenticated the user\n    app.get('/auth/facebook/callback',\n        passport.authenticate('facebook', {\n            successRedirect : '/canvas',\n            failureRedirect : '/'\n        }));\n\n    // route for logging out\n    app.get('/logout', function(req, res) {\n        req.logout();\n        res.redirect('/');\n    });\n\n    app.post('/upload', isLoggedIn, function(req, res){\n        var file = upload.router(req, res);\n    });\n\n};\n\n// route middleware to make sure a user is logged in\nfunction isLoggedIn(req, res, next) {\n\n    // if user is authenticated in the session, carry on\n    if (req.isAuthenticated())\n        return next();\n\n    // if they aren't redirect them to the home page\n    res.redirect('/');\n}\n\n\n/** WEBPACK FOOTER **\n ** ./routes.js\n **/","var exports = module.exports = {};\nvar crypto = require('crypto');\nvar multer = require('multer');\nvar mime = require('mime');\nvar storage = multer.diskStorage({\n\tdestination: function(req, file, callback){\n\t\tcallback(null, './public/uploads');\n\t},\n\tfilename: function (req, file, cb) {\n\t\tcrypto.pseudoRandomBytes(16, function (err, raw) {\n\t\t\tcb(null, raw.toString('hex') + '.' + mime.extension(file.mimetype));\n\t\t});\n\t}\n});\n\nvar upload = multer({storage : storage}).single('wireframe');\n\nexports.router = (req, res) => {\n\tupload(req, res, function(err){\n\t\tif(err){\n            console.log(err);\n\t\t\treturn res.end('Error uploading file.');\n\t\t}\n\t\treq.file.success=true;\n\t\tres.json(req.file);\n        return req.file;\n\t});\n}\n\n\n/** WEBPACK FOOTER **\n ** ./modules/upload.js\n **/","module.exports = require(\"crypto\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"crypto\"\n ** module id = 20\n ** module chunks = 0\n **/","module.exports = require(\"multer\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"multer\"\n ** module id = 21\n ** module chunks = 0\n **/","module.exports = require(\"mime\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"mime\"\n ** module id = 22\n ** module chunks = 0\n **/"],"sourceRoot":""}